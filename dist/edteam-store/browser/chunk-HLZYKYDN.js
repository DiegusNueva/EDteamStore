import{$ as It,A as ut,C as A,D as ft,G as gt,K as Ct,S as ht,T as W,U as z,V as H,W as _t,X as vt,Y as Q,Z as xt,_ as yt,a as E,g as ot,h as k,i as X,j as T,k as q,l as at,n as ct,p as dt,r as st,u as mt,w as lt,y as pt,z as B}from"./chunk-CKMUKVGC.js";import{$b as U,Ab as P,Bb as n,Cb as r,Db as et,Gb as D,Jb as h,Lb as l,Ob as it,Oc as $,Rc as w,Sc as nt,Va as Z,Wb as a,Xb as O,Ya as c,Yb as f,Za as m,Zb as rt,_b as N,aa as y,ac as R,ba as L,dc as _,ec as v,fa as I,ga as Y,jb as tt,ka as b,la as V,pb as p,rb as u,sa as g,ta as C,wb as j,xb as S,yc as K,zb as M}from"./chunk-JCEMEMJZ.js";var J=(()=>{class e{http;baseUrl=T.apiUrl;cartItems=tt([]);constructor(t){this.http=t;let i=localStorage.getItem("cartItems");i&&this.cartItems.set(JSON.parse(i))}items=K(()=>this.cartItems());cartItemCount=K(()=>this.cartItems().reduce((t,i)=>t+i.quantity,0));addToCart(t){let i=this.cartItems().findIndex(o=>o.productId===t.id);if(i>-1)this.cartItems()[i].quantity+=1;else{let o={productId:t.id,quantity:1,product:t};this.cartItems().push(o)}this.updateCart()}updateQuantity(t,i){let o=this.cartItems().findIndex(s=>s.productId===t);o>-1&&(this.cartItems()[o].quantity=i,this.updateCart())}removeFromCart(t){this.cartItems.update(i=>i.filter(o=>o.productId!==t)),this.updateCart()}clearCart(){this.cartItems.set([]),this.updateCart()}updateCart(){localStorage.setItem("cartItems",JSON.stringify(this.cartItems())),this.cartItems.set(JSON.parse(localStorage.getItem("cartItems")||"[]"))}findProductById(t){let i=`${this.baseUrl}/products/${t}`;return this.http.get(i)}static \u0275fac=function(i){return new(i||e)(I(E))};static \u0275prov=y({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();var G=(()=>{class e{http;baseUrl=T.apiUrl;constructor(t){this.http=t}createOrder(t){let i=`${this.baseUrl}/orders`;return this.http.post(i,t)}getOrdersByCustomer(t){let i=`${this.baseUrl}/ordersByCustomer/${t}`;return this.http.get(i)}static \u0275fac=function(i){return new(i||e)(I(E))};static \u0275prov=y({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();function Lt(e,d){if(e&1){let t=D();n(0,"div",3)(1,"mat-card",9)(2,"mat-card-header")(3,"mat-card-title"),a(4),r(),n(5,"mat-card-subtitle"),a(6),_(7,"currency"),r()(),n(8,"mat-card-content")(9,"p"),a(10,"Cantidad: "),n(11,"input",10),R("ngModelChange",function(o){let s=g(t).$implicit;return U(s.quantity,o)||(s.quantity=o),C(o)}),h("change",function(){let o=g(t).$implicit,s=l(2);return C(s.updateQuantity(o.productId,o.quantity))}),r()(),n(12,"button",11),h("click",function(){let o=g(t).$implicit,s=l(2);return C(s.removeItem(o.productId))}),a(13,"Eliminar"),r()()()()}if(e&2){let t=d.$implicit;c(4),O(t.product==null?null:t.product.name),c(2),f("Precio: ",v(7,3,t.product==null?null:t.product.price,"USD","symbol","1.2-2"),""),c(5),N("ngModel",t.quantity)}}function Vt(e,d){e&1&&(n(0,"p",4),a(1,"No hay productos en el carrito."),r())}function Nt(e,d){if(e&1){let t=D();n(0,"div",0)(1,"h1",1),a(2,"Carrito de Compras"),r(),n(3,"div",2),M(4,Lt,14,8,"div",3,S,!1,Vt,2,0,"p",4),r(),n(7,"div",5)(8,"h3"),a(9),_(10,"currency"),r()(),n(11,"div",6)(12,"button",7),h("click",function(){g(t);let o=l();return C(o.placeOrder())}),a(13,"Generar Pedido"),r(),n(14,"button",8),a(15,"Continuar Comprando"),r()()()}if(e&2){let t=l();c(4),P(t.itemsInCart),c(5),f("Total: ",v(10,2,t.totalAmount,"USD","symbol","1.2-2"),"")}}function Ut(e,d){e&1&&(n(0,"div",0)(1,"p",4),a(2,"No hay productos en el carrito."),r(),n(3,"div",6)(4,"button",8),a(5,"Ir al Cat\xE1logo"),r()()())}var Et=(()=>{class e{cartService;orderService;router;snackBar;authService;cartItems=[];totalAmount=0;loginResponse;constructor(t,i,o,s,F){this.cartService=t,this.orderService=i,this.router=o,this.snackBar=s,this.authService=F,this.loginResponse=this.authService.getLoginResponse()}ngOnInit(){this.calculateTotal()}get itemsInCart(){return this.cartService.items()}updateQuantity(t,i){this.cartService.updateQuantity(t,i),this.calculateTotal()}removeItem(t){this.cartService.removeFromCart(t),this.calculateTotal()}calculateTotal(){this.totalAmount=0,this.itemsInCart.forEach(t=>{this.cartService.findProductById(t.productId).subscribe({next:i=>{this.totalAmount+=t.quantity*i.price},error:()=>{this.showSnackBar("Error al obtener el producto.")}})})}placeOrder(){let t={customerId:this.loginResponse.user.id,date:new Date().toISOString().split("T")[0],cartItems:this.itemsInCart.map(i=>({productId:i.productId,quantity:i.quantity})),total:this.totalAmount};this.orderService.createOrder(t).subscribe({next:()=>{this.showSnackBar("Pedido realizado con \xE9xito"),this.cartService.clearCart(),this.router.navigate(["/orders"])},error:()=>{this.showSnackBar("Error en el registro. Por favor, intenta de nuevo.")}})}showSnackBar(t){this.snackBar.open(t,"Cerrar",{duration:3e3})}static \u0275fac=function(i){return new(i||e)(m(J),m(G),m(ot),m(A),m(q))};static \u0275cmp=b({type:e,selectors:[["app-cart-item-detail"]],decls:2,vars:1,consts:[[1,"container","py-5"],[1,"fw-bold","text-center"],[1,"card-container"],[1,"cart-item-card"],[1,"text-center"],[1,"total-container"],[1,"actions-container"],["mat-raised-button","","color","primary",3,"click"],["mat-button","","color","accent","routerLink","/product/catalog"],[1,"example-card"],["type","number","min","1",3,"ngModelChange","change","ngModel"],["mat-button","","color","warn",3,"click"]],template:function(i,o){i&1&&p(0,Nt,16,7,"div",0)(1,Ut,6,0,"div",0),i&2&&j(o.itemsInCart.length>0?0:1)},dependencies:[k,B,W,H,Q,_t,z,at,st,ct,mt,dt,w],styles:[".container[_ngcontent-%COMP%]{max-width:800px;margin:0 auto;padding:20px}.cart-item-card[_ngcontent-%COMP%]{margin-bottom:20px}.example-card[_ngcontent-%COMP%]{width:100%}.mat-card-header[_ngcontent-%COMP%], .mat-card-content[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center}.mat-card-content[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin-bottom:0}.actions-container[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-top:20px}.actions-container[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{padding:12px 24px;font-size:16px;border-radius:4px;text-transform:uppercase}.actions-container[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:first-child{background-color:#1976d2;color:#fff}.actions-container[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:last-child{background-color:#f50057;color:#fff}.actions-container[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{opacity:.8}"]})}return e})();var kt=(()=>{class e{http;baseUrl=T.apiUrl;constructor(t){this.http=t}getProducts(){let t=`${this.baseUrl}/products`;return this.http.get(t)}getCategories(){let t=`${this.baseUrl}/categories`;return this.http.get(t)}static \u0275fac=function(i){return new(i||e)(I(E))};static \u0275prov=y({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();function $t(e,d){if(e&1&&(n(0,"mat-option",8),a(1),r()),e&2){let t=d.$implicit;u("value",t.id),c(),O(t.name)}}function qt(e,d){if(e&1){let t=D();n(0,"div",11)(1,"mat-card",12)(2,"mat-card-header")(3,"mat-card-title"),a(4),r()(),et(5,"img",13),n(6,"mat-card-content")(7,"p"),a(8),r(),n(9,"p"),a(10),_(11,"currency"),r()(),n(12,"mat-card-actions",14)(13,"button",15),h("click",function(){let o=g(t).$implicit,s=l();return C(s.addToCart(o))}),a(14,"A\xF1adir al Carrito"),r()()()()}if(e&2){let t=d.$implicit;c(4),O(t.name),c(),it("alt","Imagen de ",t.name,""),u("src",t.image,Z),c(3),O(t.description),c(2),f("Precio: ",v(11,6,t.price,"USD","symbol","1.2-2"),"")}}function At(e,d){e&1&&(n(0,"p"),a(1,"No hay productos disponibles."),r())}var Tt=(()=>{class e{productService;cartService;products=[];filteredProducts=[];categories=[];selectedCategory=null;cartItemCount=0;constructor(t,i){this.productService=t,this.cartService=i}ngOnInit(){this.loadProducts(),this.loadCategories()}get countInCart(){return this.cartService.cartItemCount()}loadProducts(){this.productService.getProducts().subscribe({next:t=>{this.products=t,this.filteredProducts=t},error:t=>{console.error("Error fetching products",t)}})}loadCategories(){this.productService.getCategories().subscribe({next:t=>{this.categories=t},error:t=>{console.error("Error fetching categories",t)}})}filterByCategory(){this.selectedCategory?this.filteredProducts=this.products.filter(t=>t.categoryId===this.selectedCategory):this.filteredProducts=this.products}addToCart(t){this.cartService.addToCart(t)}static \u0275fac=function(i){return new(i||e)(m(kt),m(J))};static \u0275cmp=b({type:e,selectors:[["app-product-catalog"]],decls:20,vars:5,consts:[[1,"container"],[1,"top-bar"],[1,"cart-badge"],["mat-icon-button","","routerLink","/product/cart","matBadgeColor","warn","matBadgePosition","above after",3,"matBadge"],["mat-button","","color","primary","routerLink","/product/order-list",1,"view-orders-button"],[1,"category-filter"],["appearance","fill"],[3,"valueChange","selectionChange","value"],[3,"value"],[3,"value",4,"ngFor","ngForOf"],[1,"card-container"],[1,"product-card"],[1,"example-card"],["mat-card-image","",3,"src","alt"],[1,"card-actions"],["mat-raised-button","","color","primary",3,"click"]],template:function(i,o){i&1&&(n(0,"div",0)(1,"div",1)(2,"div",2)(3,"button",3)(4,"mat-icon"),a(5,"shopping_cart"),r()()(),n(6,"button",4),a(7," Ver Mis Pedidos "),r()(),n(8,"div",5)(9,"mat-form-field",6)(10,"mat-label"),a(11,"Filtrar por Categor\xEDa"),r(),n(12,"mat-select",7),R("valueChange",function(F){return U(o.selectedCategory,F)||(o.selectedCategory=F),F}),h("selectionChange",function(){return o.filterByCategory()}),n(13,"mat-option",8),a(14,"Todas las Categor\xEDas"),r(),p(15,$t,2,2,"mat-option",9),r()()(),n(16,"div",10),M(17,qt,15,11,"div",11,S,!1,At,2,0,"p"),r()()),i&2&&(c(3),u("matBadge",o.countInCart),c(9),N("value",o.selectedCategory),c(),u("value",null),c(2),u("ngForOf",o.categories),c(2),P(o.filteredProducts))},dependencies:[$,k,gt,ft,B,ut,Ct,W,vt,H,Q,xt,z,ht,pt,yt,w],styles:[".container[_ngcontent-%COMP%]{max-width:800px;margin:0 auto;padding:20px}.top-bar[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:20px}.cart-badge[_ngcontent-%COMP%]{margin-right:10px}.category-filter[_ngcontent-%COMP%]{display:flex;justify-content:center;margin-bottom:20px}.card-container[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(3,1fr);gap:20px}.product-card[_ngcontent-%COMP%]{width:100%;max-width:300px}.example-card[_ngcontent-%COMP%]{width:100%}.card-actions[_ngcontent-%COMP%]{display:flex;justify-content:flex-end}.view-orders-button[_ngcontent-%COMP%]{padding:12px 24px;font-size:16px;border-radius:4px;text-transform:uppercase;background-color:#1976d2;color:#fff;border:none;cursor:pointer;transition:background-color .3s}.view-orders-button[_ngcontent-%COMP%]:hover{background-color:#0d47a1}.view-orders-button[_ngcontent-%COMP%]:focus{outline:none;background-color:#0d47a1}"]})}return e})();function Wt(e,d){if(e&1&&(n(0,"li")(1,"p"),a(2),r()()),e&2){let t=d.$implicit;c(2),rt("",t.productName," - Cantidad: ",t.quantity,"")}}function zt(e,d){if(e&1&&(n(0,"div")(1,"p")(2,"strong"),a(3,"Total:"),r(),a(4),_(5,"currency"),r()()),e&2){let t=l().$implicit;c(4),f(" ",v(5,1,t.total,"USD","symbol","1.2-2"),"")}}function Ht(e,d){if(e&1&&(n(0,"div",6)(1,"div",7)(2,"p")(3,"strong"),a(4,"Fecha:"),r(),a(5),r()(),n(6,"div",8)(7,"h4"),a(8,"\xCDtems del Carrito:"),r(),n(9,"ul"),p(10,Wt,3,2,"li",9),r()(),p(11,zt,6,6,"div"),r()),e&2){let t=d.$implicit;c(5),f(" ",t.date,""),c(5),u("ngForOf",t.cartItems),c(),j(t.total?11:-1)}}function Qt(e,d){if(e&1&&(n(0,"div",4),M(1,Ht,12,3,"div",6,S),r()),e&2){let t=l();c(),P(t.orders)}}function Jt(e,d){e&1&&(n(0,"p",5),a(1,"No hay pedidos disponibles."),r())}var Bt=(()=>{class e{ordersService;snackBar;orders=[];authService=Y(q);loginResponse;constructor(t,i){this.ordersService=t,this.snackBar=i,this.loginResponse=this.authService.getLoginResponse()}ngOnInit(){this.loadOrders()}loadOrders(){this.ordersService.getOrdersByCustomer(this.loginResponse.user.id).subscribe({next:t=>{this.orders=t},error:()=>{this.showSnackBar("Error fetching orders")}})}showSnackBar(t){this.snackBar.open(t,"Cerrar",{duration:3e3})}static \u0275fac=function(i){return new(i||e)(m(G),m(A))};static \u0275cmp=b({type:e,selectors:[["app-order-list"]],decls:8,vars:1,consts:[[1,"container"],[1,"fw-bold","text-center"],[1,"top-bar"],["mat-raised-button","","color","primary","routerLink","/product/catalog",1,"view-catalog-button"],[1,"order-grid"],[1,"text-center"],[1,"order-card"],[1,"order-info"],[1,"cart-items"],[4,"ngFor","ngForOf"]],template:function(i,o){i&1&&(n(0,"div",0)(1,"h1",1),a(2,"Lista de Pedidos"),r(),n(3,"div",2)(4,"button",3),a(5," Ver Cat\xE1logo "),r()(),p(6,Qt,3,0,"div",4)(7,Jt,2,0,"p",5),r()),i&2&&(c(6),j(o.orders.length>0?6:7))},dependencies:[$,k,B,w],styles:[".container[_ngcontent-%COMP%]{max-width:800px;margin:0 auto;padding:20px}.top-bar[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;margin-bottom:20px}.view-catalog-button[_ngcontent-%COMP%], .view-orders-button[_ngcontent-%COMP%]{padding:12px 24px;font-size:16px;border-radius:4px;text-transform:uppercase}.view-catalog-button[_ngcontent-%COMP%]:hover, .view-orders-button[_ngcontent-%COMP%]:hover{background-color:#1976d2;color:#fff}.view-catalog-button[_ngcontent-%COMP%]:focus, .view-orders-button[_ngcontent-%COMP%]:focus{outline:none}.order-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fill,minmax(300px,1fr));gap:20px}.order-card[_ngcontent-%COMP%]{border:1px solid #ccc;padding:10px}.order-info[_ngcontent-%COMP%], .cart-items[_ngcontent-%COMP%]{margin-bottom:10px}.text-center[_ngcontent-%COMP%]{text-align:center}"]})}return e})();var Gt=[{path:"catalog",component:Tt},{path:"cart",component:Et},{path:"order-list",component:Bt}],Ft=(()=>{class e{static \u0275fac=function(i){return new(i||e)};static \u0275mod=V({type:e});static \u0275inj=L({imports:[X.forChild(Gt),X]})}return e})();var Be=(()=>{class e{static \u0275fac=function(i){return new(i||e)};static \u0275mod=V({type:e});static \u0275inj=L({imports:[nt,Ft,It,lt]})}return e})();export{Be as ProductModule};
